<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{fragments/layout}"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<!-- ##1 -->
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body style="background-color:#D9D9D9">
	<div layout:fragment="content">

		<div class="container d-flex flex-column justify-content-center align-items-center">

			<div class="container bg-secondary rounded-top-5" style="max-width: 1000px; height: 20px;"></div>
			
			<div class="container bg-secondary d-flex" style="max-width: 1000px; height: 300px;">
				<div class="container bg-secondary d-flex align-items-center" style="max-width: 30%; max-height: 100%;">
				  <section class="bg-white rounded-circle d-flex justify-content-center align-items-center position-relative" style="width: 100%; height: 90%;">
				    
				    <!-- 아바타 이미지-->
				    <img src="/images/member_avatar.png" alt="아바타"
				         class="position-absolute"
				         style="z-index: 1; max-width: 90%; max-height: 80%;">
				    
				    <div style="z-index: 2; position: relative; color: gray;">아바타 바꾸기</div>
				
				  </section>
				</div>
				
				<!-- 사용자 별명(displayName) -->
				<div class="container bg-secondary text-white d-flex flex-column" style="max-width: 60%; max-height: 100%;">
				  <h1 class="row align-items-end" th:href="@{/member/member}" sec:authorize="isAuthenticated()"
				      sec:authentication="principal.username" style="font-size: 55px; height: 50%"> </h1>
				  
				  <div class="container bg-secondary text-dark d-flex align-items-end" style="height: 40%;">
				  	<span class="badge bg-success col-2" style="height: 20%">dd</span>
				  	<span class="badge bg-success col-2" style="height: 20%">dd</span>
				  	<span class="badge bg-success col-2" style="height: 20%">dd</span>
				  </div>
				</div>
			
			</div>
			
			<div class="container bg-secondary" style="max-width: 1000px; height: 10px;"></div>
			<div class="container bg-secondary rounded-bottom-3" style="max-width: 1000px; height: 800px;">
			  <div class="d-flex container bg-light rounded-bottom-3 rounded-top-3 justify-content-end" style="max-width: 100%; height: 99%;">
				
				<!-- 메인 -->
				<div class="bg-white p-4 shadow-lg rounded-3 me-auto" style="width: 74%;">
					
					
					<form method="post" th:action="@{/member/mypage/umobile}">
					
						<input type="text" name="memberId2" id="memberId2" class="form-control memberId2" th:value="${#authentication.name}" readonly>
					
						<input type="tel" name="mobileNumber" id="mobileNumber" class="form-control mobileNumber" value="원래 번호" readonly>
						
						<input type="password" name="memberPass" id="memberPass" class="form-control" placeholder="비밀번호 입력">
						
						<input type="tel" name="newMobileNumber" id="newMobileNumber" class="form-control" placeholder="새 번호">
						
						<input type="submit" class="btn btn-outline-success" value="변경하기">
					
					</form>
					
					
				</div>
					
				
				<!-- 내비게이터 -->
			    <div class="d-flex flex-column align-items-end bg-light" style="height: 100%; width: 25%; gap:20px">
			    	<div class="btn btn-outline-light bg-white text-dark shadow-sm mt-3" style="width: 100%"><a th:href="@{/member/mypage/main}" style="text-decoration: none; color:black;">도서대출현황</a></div>
			    	<div class="btn btn-outline-light bg-white text-dark shadow-sm" style="width: 100%"><a th:href="@{/member/mypage/upass}" style="text-decoration: none; color:black;">비밀번호변경</a></div>
			    	<div class="btn btn-outline-light bg-white text-dark shadow-sm" style="width: 100%"><a th:href="@{/member/mypage/uemail}" style="text-decoration: none; color:black;">이메일변경</a></div>
			    	<div class="btn btn-outline-light bg-white text-dark shadow-sm" style="width: 100%"><a th:href="@{/member/mypage/uaddress}" style="text-decoration: none; color:black;">주소지변경</a></div>
			    	<div class="btn btn-outline-light bg-white text-dark shadow-sm" style="width: 100%"><a th:href="@{/member/mypage/umobile}" style="text-decoration: none; color:black;">휴대전화번호변경</a></div>
			    	<div class="btn btn-outline-light bg-white text-dark shadow-sm" style="width: 100%"><a th:href="@{/member/mypage/udname}" style="text-decoration: none; color:black;">별명변경</a></div>
			    </div>
			  
			  </div>
			</div>

		</div>
		<script>
	  	// memberId값으로 mobileNumber 값 가져오기
	  	 $(document).ready(function() {
	         var memberId = $("#memberId2").val().trim();

	         $.ajax({
	             url: "/40db/getMobileNumberByMemberId",
	             method: "GET",
	             data: { memberId: memberId },
	             success: function(mobileNumber) {
	                 if (mobileNumber) {
	                   var formattedNumber = mobileNumber.replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
	                   $('#mobileNumber').val(formattedNumber);
	                 }
	               },
	             error: function() {
	                 console.log("mobileNumber을 가져오는 데 실패했습니다.");
	             }
	         });
	     });
		
		</script>


	</div>
</body>
</html>